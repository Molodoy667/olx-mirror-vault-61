name: üåê PWA Build Only

on:
  workflow_dispatch:
    inputs:
      create_release:
        description: 'Create GitHub Release'
        required: false
        default: 'true'
        type: boolean

jobs:
  build-pwa:
    runs-on: ubuntu-latest
    
    steps:
    - name: üì• Checkout
      uses: actions/checkout@v4
      
    - name: üì¶ Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: üìã Install dependencies
      run: npm install --legacy-peer-deps
      
    - name: üèóÔ∏è Build PWA
      run: npm run build
      
    - name: üìä Build info
      run: |
        echo "‚úÖ PWA build completed!"
        echo "üìÅ Build size:"
        du -sh dist/
        echo "üìã Key files:"
        ls -la dist/index.html dist/manifest.json dist/sw.js 2>/dev/null || echo "Some files missing"
        
    - name: üì¶ Package PWA
      run: |
        cd dist
        zip -r ../novado-pwa.zip .
        cd ..
        echo "üì¶ PWA packaged as ZIP"
        
    - name: üìã Get version
      id: version
      run: echo "VERSION=$(date +'%Y.%m.%d-%H%M')-pwa" >> $GITHUB_OUTPUT
      
    - name: üöÄ Create PWA Release
      if: ${{ github.event.inputs.create_release == 'true' }}
      uses: softprops/action-gh-release@v1
      with:
        tag_name: v${{ steps.version.outputs.VERSION }}
        name: üåê Novado PWA v${{ steps.version.outputs.VERSION }}
        body: |
          üåê **PWA Build Ready!**
          
          üìÖ –í–µ—Ä—Å—ñ—è: ${{ steps.version.outputs.VERSION }}
          üåê –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: Progressive Web App
          
          ### üì• –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è PWA:
          1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Å–∞–π—Ç —É –±—Ä–∞—É–∑–µ—Ä—ñ
          2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏" –≤ –∞–¥—Ä–µ—Å–Ω–æ–º—É —Ä—è–¥–∫—É
          3. –ê–±–æ –¥–æ–¥–∞–π—Ç–µ –Ω–∞ –≥–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω
          
          ### üì¶ ZIP –∞—Ä—Ö—ñ–≤:
          - –ú—ñ—Å—Ç–∏—Ç—å –≤—Å—ñ —Ñ–∞–π–ª–∏ PWA
          - –ì–æ—Ç–æ–≤–∏–π –¥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ –±—É–¥—å-—è–∫–æ–º—É —Ö–æ—Å—Ç–∏–Ω–≥—É
          - –ü—Ä–∞—Ü—é—î –∑ –±—É–¥—å-—è–∫–∏–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–º
          
          ### ‚ú® –§—É–Ω–∫—Ü—ñ—ó:
          - üé¨ Splash screen –∑ –∞–Ω—ñ–º–∞—Ü—ñ—î—é
          - üì± –Ü–∫–æ–Ω–∫–∞ –∑ –±—É–∫–≤–æ—é N  
          - üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π –±—Ä–µ–Ω–¥–∏–Ω–≥
          - üîÑ Service Worker –¥–ª—è –∞–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω—å
          - üì± Responsive –¥–∏–∑–∞–π–Ω
          
        files: |
          novado-pwa.zip
          dist/index.html
          dist/manifest.json
        draft: false
        prerelease: false
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        
    - name: üì§ Upload PWA artifacts
      uses: actions/upload-artifact@v4
      with:
        name: novado-pwa-build
        path: |
          dist/
          novado-pwa.zip