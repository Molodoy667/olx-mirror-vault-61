import{h as N,u as y,v as w,r as q,s as n,j as e,B as r,t as u}from"./index-KbJkRX07.js";import{u as T}from"./useQuery-DYBXd3SC.js";import{u as x}from"./useMutation-BJki3aSv.js";import{H as C,b as S}from"./Footer-CG381HwE.js";import{T as k,a as E,b as h,c as z}from"./tabs-Bq0uXDOJ.js";import{E as p}from"./eye-jg7wg44x.js";import{E as v}from"./eye-off-DmAdVWQx.js";import{S as A}from"./square-pen-q68WjATM.js";import{T as F}from"./trash-2-CCvey3Fk.js";import{P as L}from"./Combination-CN-dILO0.js";import"./useAdmin-wN6CKAL8.js";import"./badge-DpjjU75J.js";import"./index-D5jjwgwZ.js";import"./select-CxSQralT.js";import"./index-ohYBQjSJ.js";import"./globe-BvyP_gKp.js";import"./uk-Drv84rxe.js";import"./star-B840Te7u.js";import"./heart-BstkNJZ-.js";import"./avatar-CGybcn-y.js";import"./user-Dt39FPRe.js";import"./search-B1u6Ento.js";import"./plus-D5zmitre.js";function te(){const{user:c}=N(),i=y(),m=w(),[t,j]=q.useState("active");if(!c)return i("/auth"),null;const{data:o,isLoading:g}=T({queryKey:["my-listings",c.id,t],queryFn:async()=>{const{data:s,error:a}=await n.from("listings").select("*").eq("user_id",c.id).eq("status",t).order("created_at",{ascending:!1});if(a)throw a;return s}}),f=x({mutationFn:async({id:s,currentStatus:a})=>{const d=a==="active"?"inactive":"active",{error:l}=await n.from("listings").update({status:d}).eq("id",s);if(l)throw l;return d},onSuccess:s=>{m.invalidateQueries({queryKey:["my-listings"]}),u({title:s==="active"?"Оголошення активовано":"Оголошення деактивовано"})}}),b=x({mutationFn:async s=>{const{error:a}=await n.from("listings").delete().eq("id",s);if(a)throw a},onSuccess:()=>{m.invalidateQueries({queryKey:["my-listings"]}),u({title:"Оголошення видалено"})}});return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(C,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Мої оголошення"}),e.jsxs(k,{value:t,onValueChange:j,children:[e.jsxs(E,{className:"mb-6",children:[e.jsxs(h,{value:"active",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Активні"]}),e.jsxs(h,{value:"inactive",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Неактивні"]})]}),e.jsx(z,{value:t,children:g?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[...Array(8)].map((s,a)=>e.jsxs("div",{className:"bg-card rounded-lg p-4 animate-pulse",children:[e.jsx("div",{className:"aspect-square bg-muted rounded-lg mb-3"}),e.jsx("div",{className:"h-4 bg-muted rounded mb-2"}),e.jsx("div",{className:"h-3 bg-muted rounded w-2/3"})]},a))}):o&&o.length>0?e.jsx("div",{className:"space-y-4",children:o.map(s=>{var a;return e.jsxs("div",{className:"bg-card rounded-lg p-4 flex items-center gap-4",children:[e.jsx("img",{src:((a=s.images)==null?void 0:a[0])||"/placeholder.svg",alt:s.title,className:"w-24 h-24 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:s.title}),e.jsx("p",{className:"text-muted-foreground mb-2",children:s.price?`${s.price.toLocaleString("uk-UA")} ${s.currency}`:"Безкоштовно"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.views," переглядів • ",s.location]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>i(`/listing/${s.id}`),children:"Переглянути"}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>i(`/edit/${s.id}`),children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>f.mutate({id:s.id,currentStatus:s.status}),children:s.status==="active"?e.jsx(v,{className:"w-4 h-4"}):e.jsx(p,{className:"w-4 h-4"})}),e.jsx(r,{variant:"destructive",size:"sm",onClick:()=>{confirm("Ви впевнені, що хочете видалити це оголошення?")&&b.mutate(s.id)},children:e.jsx(F,{className:"w-4 h-4"})})]})]},s.id)})}):e.jsxs("div",{className:"text-center py-12 bg-card rounded-lg",children:[e.jsx(L,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:["У вас немає ",t==="active"?"активних":"неактивних"," оголошень"]}),t==="active"&&e.jsx(r,{onClick:()=>i("/create"),children:"Створити оголошення"})]})})]})]}),e.jsx(S,{})]})}export{te as default};
