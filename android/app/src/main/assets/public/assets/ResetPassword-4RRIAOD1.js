import{u as A,x as U,r as o,j as e,k as N,m as v,C as V,n as y,o as P,p as H,g as i,B as Z,s as d,t as x}from"./index-KbJkRX07.js";import{I as k}from"./input-BfmWFPkP.js";import{L as S}from"./label-CwWGJCIM.js";import{L as C}from"./lock-B5C9YPp5.js";import{E}from"./eye-off-DmAdVWQx.js";import{E as L}from"./eye-jg7wg44x.js";import{C as D}from"./circle-check-big-HnBDMycv.js";function X(){const l=A();U();const[t,F]=o.useState({password:"",confirmPassword:""}),[h,u]=o.useState(!1),[c,I]=o.useState(!1),[m,_]=o.useState(!1),[r,f]=o.useState({}),[B,p]=o.useState(!1);o.useEffect(()=>{(async()=>{const{data:{session:a}}=await d.auth.getSession();if(a)p(!0);else{const w=new URLSearchParams(window.location.hash.substring(1)),j=w.get("access_token"),b=w.get("refresh_token");if(j&&b){const{error:T}=await d.auth.setSession({access_token:j,refresh_token:b});T?(x({title:"Недійсне посилання",description:"Посилання для скидання паролю недійсне або прострочене",variant:"destructive"}),l("/forgot-password")):p(!0)}else l("/forgot-password")}})()},[l]);const O=()=>{const s={};return t.password?t.password.length<6&&(s.password="Пароль повинен містити мінімум 6 символів"):s.password="Пароль обов'язковий",t.confirmPassword?t.password!==t.confirmPassword&&(s.confirmPassword="Паролі не співпадають"):s.confirmPassword="Підтвердження паролю обов'язкове",f(s),Object.keys(s).length===0},R=async s=>{if(s.preventDefault(),!!O()){u(!0);try{const{error:a}=await d.auth.updateUser({password:t.password});if(a)throw a;x({title:"Пароль змінено!",description:"Ваш пароль успішно оновлено"}),await d.auth.signOut(),l("/auth")}catch(a){x({title:"Помилка",description:a.message||"Не вдалося змінити пароль",variant:"destructive"})}finally{u(!1)}}},g=(s,a)=>{F({...t,[s]:a}),r[s]&&f({...r,[s]:""})},n=(s=>s.length===0?{strength:0,text:"",color:""}:s.length<6?{strength:1,text:"Слабкий",color:"text-red-500"}:s.length<8?{strength:2,text:"Середній",color:"text-yellow-500"}:s.length>=8&&/[A-Z]/.test(s)&&/[0-9]/.test(s)?{strength:3,text:"Сильний",color:"text-green-500"}:{strength:2,text:"Середній",color:"text-yellow-500"})(t.password);return B?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 flex items-center justify-center px-4 py-8",children:e.jsx("div",{className:"w-full max-w-md animate-fade-in",children:e.jsxs(N,{className:"backdrop-blur-sm bg-card/95 shadow-xl border-border/50",children:[e.jsxs(v,{className:"space-y-1 text-center pb-8",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-primary/80 bg-clip-text text-transparent",children:"Novado"})}),e.jsx(y,{className:"text-2xl font-semibold",children:"Створити новий пароль"}),e.jsx(P,{className:"text-muted-foreground",children:"Введіть новий пароль для вашого облікового запису"})]}),e.jsx(H,{children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"password",className:"text-sm font-medium",children:"Новий пароль"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(k,{id:"password",type:c?"text":"password",placeholder:"Введіть новий пароль",value:t.password,onChange:s=>g("password",s.target.value),className:i("pl-10 pr-10",r.password&&"border-red-500 focus-visible:ring-red-500")}),e.jsx("button",{type:"button",onClick:()=>I(!c),className:"absolute right-3 top-3 text-muted-foreground hover:text-foreground transition-colors",children:c?e.jsx(E,{className:"w-4 h-4"}):e.jsx(L,{className:"w-4 h-4"})})]}),t.password&&e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-muted rounded-full h-2",children:e.jsx("div",{className:i("h-2 rounded-full transition-all duration-300",n.strength===1&&"w-1/3 bg-red-500",n.strength===2&&"w-2/3 bg-yellow-500",n.strength===3&&"w-full bg-green-500")})}),e.jsx("span",{className:i("text-xs font-medium",n.color),children:n.text})]})}),r.password&&e.jsx("p",{className:"text-sm text-red-500",children:r.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"confirmPassword",className:"text-sm font-medium",children:"Підтвердити пароль"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(k,{id:"confirmPassword",type:m?"text":"password",placeholder:"Підтвердіть новий пароль",value:t.confirmPassword,onChange:s=>g("confirmPassword",s.target.value),className:i("pl-10 pr-10",r.confirmPassword&&"border-red-500 focus-visible:ring-red-500")}),e.jsx("button",{type:"button",onClick:()=>_(!m),className:"absolute right-3 top-3 text-muted-foreground hover:text-foreground transition-colors",children:m?e.jsx(E,{className:"w-4 h-4"}):e.jsx(L,{className:"w-4 h-4"})})]}),t.confirmPassword&&t.password===t.confirmPassword&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{children:"Паролі співпадають"})]}),r.confirmPassword&&e.jsx("p",{className:"text-sm text-red-500",children:r.confirmPassword})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 border border-border/50",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Рекомендації для надійного паролю:"}),e.jsxs("ul",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsx("li",{children:"• Мінімум 8 символів"}),e.jsx("li",{children:"• Включайте великі та малі літери"}),e.jsx("li",{children:"• Додайте цифри та спеціальні символи"}),e.jsx("li",{children:"• Не використовуйте особисту інформацію"})]})]}),e.jsx(Z,{type:"submit",className:"w-full h-11 font-medium",disabled:h,children:h?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Змінюємо пароль..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Змінити пароль"]})})]})})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 flex items-center justify-center px-4 py-8",children:e.jsx("div",{className:"w-full max-w-md animate-fade-in",children:e.jsx(N,{className:"backdrop-blur-sm bg-card/95 shadow-xl border-border/50",children:e.jsxs(v,{className:"text-center pb-8",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-orange-100 dark:bg-orange-900/20 rounded-full flex items-center justify-center mb-4",children:e.jsx(V,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})}),e.jsx(y,{className:"text-2xl font-semibold",children:"Завантаження..."}),e.jsx(P,{className:"text-muted-foreground",children:"Перевіряємо посилання для скидання паролю"})]})})})})}export{X as default};
