import{r as b,v as C,j as e,B as l,k as V,s as d,t as o}from"./index-KbJkRX07.js";import{u as P}from"./useQuery-DYBXd3SC.js";import{u as x}from"./useMutation-BJki3aSv.js";import{A as U,a as k}from"./AdminHeader-BFn_Zmrn.js";import{I as h}from"./input-BfmWFPkP.js";import{L as i}from"./label-CwWGJCIM.js";import{T as A}from"./textarea-dp5bmWKD.js";import{S as p,d as j,e as v,f as y,g as t}from"./select-CxSQralT.js";import{B as _}from"./badge-DpjjU75J.js";import{D as E,a as I,b as H,c as Q,d as B}from"./dialog-C3rICmIe.js";import{P as K}from"./plus-D5zmitre.js";import{D as L}from"./dollar-sign--DFDUvgJ.js";import{S as O}from"./square-pen-q68WjATM.js";import{T as R}from"./trash-2-CCvey3Fk.js";import"./Combination-CN-dILO0.js";import"./index-CAsdkEwS.js";import"./users-CUWo_zW8.js";import"./settings-DWrH-Tg4.js";import"./index-D5jjwgwZ.js";function de(){const[w,n]=b.useState(!1),[r,c]=b.useState(null),m=C(),{data:u,isLoading:S}=P({queryKey:["admin-tariffs"],queryFn:async()=>{const{data:s,error:a}=await d.from("tariff_plans").select("*").order("type",{ascending:!0}).order("price",{ascending:!0});if(a)throw a;return s}}),f=x({mutationFn:async s=>{const{error:a}=await d.from("tariff_plans").insert(s);if(a)throw a},onSuccess:()=>{m.invalidateQueries({queryKey:["admin-tariffs"]}),o({title:"Тариф створено успішно"}),n(!1)},onError:()=>{o({title:"Помилка",description:"Не вдалося створити тариф",variant:"destructive"})}}),g=x({mutationFn:async s=>{const{error:a}=await d.from("tariff_plans").update(s).eq("id",s.id);if(a)throw a},onSuccess:()=>{m.invalidateQueries({queryKey:["admin-tariffs"]}),o({title:"Тариф оновлено успішно"}),n(!1),c(null)}}),D=x({mutationFn:async s=>{const{error:a}=await d.from("tariff_plans").delete().eq("id",s);if(a)throw a},onSuccess:()=>{m.invalidateQueries({queryKey:["admin-tariffs"]}),o({title:"Тариф видалено успішно"})}}),q=s=>{s.preventDefault();const a=new FormData(s.currentTarget),N={name:a.get("name"),type:a.get("type"),price:Number(a.get("price")),currency:a.get("currency"),duration_days:Number(a.get("duration_days")),description:a.get("description"),is_active:a.get("is_active")==="true"};r?g.mutate({...N,id:r.id}):f.mutate(N)},F=s=>{switch(s){case"vip_listing":return"VIP Оголошення";case"promo_listing":return"Промо Оголошення";case"business_account":return"Бізнес Акаунт";default:return s}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(U,{}),e.jsxs("div",{className:"flex",children:[e.jsx(k,{}),e.jsxs("main",{className:"flex-1 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Управління тарифами"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Налаштування цін та тривалості тарифних планів"})]}),e.jsxs(E,{open:w,onOpenChange:n,children:[e.jsx(I,{asChild:!0,children:e.jsxs(l,{onClick:()=>c(null),className:"bg-gradient-to-r from-primary to-primary-glow",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Додати тариф"]})}),e.jsxs(H,{className:"max-w-md",children:[e.jsx(Q,{children:e.jsx(B,{children:r?"Редагувати тариф":"Створити новий тариф"})}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"name",children:"Назва тарифу"}),e.jsx(h,{id:"name",name:"name",defaultValue:(r==null?void 0:r.name)||"",required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"type",children:"Тип тарифу"}),e.jsxs(p,{name:"type",defaultValue:(r==null?void 0:r.type)||"",required:!0,children:[e.jsx(j,{children:e.jsx(v,{placeholder:"Оберіть тип"})}),e.jsxs(y,{children:[e.jsx(t,{value:"vip_listing",children:"VIP Оголошення"}),e.jsx(t,{value:"promo_listing",children:"Промо Оголошення"}),e.jsx(t,{value:"business_account",children:"Бізнес Акаунт"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"price",children:"Ціна"}),e.jsx(h,{id:"price",name:"price",type:"number",step:"0.01",defaultValue:(r==null?void 0:r.price)||"",required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"currency",children:"Валюта"}),e.jsxs(p,{name:"currency",defaultValue:(r==null?void 0:r.currency)||"UAH",children:[e.jsx(j,{children:e.jsx(v,{})}),e.jsxs(y,{children:[e.jsx(t,{value:"UAH",children:"UAH"}),e.jsx(t,{value:"USD",children:"USD"}),e.jsx(t,{value:"EUR",children:"EUR"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"duration_days",children:"Тривалість (днів)"}),e.jsx(h,{id:"duration_days",name:"duration_days",type:"number",defaultValue:(r==null?void 0:r.duration_days)||"",required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"description",children:"Опис"}),e.jsx(A,{id:"description",name:"description",defaultValue:(r==null?void 0:r.description)||"",rows:3})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"is_active",children:"Статус"}),e.jsxs(p,{name:"is_active",defaultValue:r!=null&&r.is_active?"true":"false",children:[e.jsx(j,{children:e.jsx(v,{})}),e.jsxs(y,{children:[e.jsx(t,{value:"true",children:"Активний"}),e.jsx(t,{value:"false",children:"Неактивний"})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{n(!1),c(null)},className:"flex-1",children:"Скасувати"}),e.jsx(l,{type:"submit",disabled:f.isPending||g.isPending,className:"flex-1",children:r?"Оновити":"Створити"})]})]})]})]})]}),e.jsx("div",{className:"grid gap-6",children:S?e.jsx("div",{className:"text-center py-8",children:"Завантаження..."}):u==null?void 0:u.map(s=>e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-xl font-semibold",children:s.name}),e.jsx(_,{variant:s.is_active?"default":"secondary",children:s.is_active?"Активний":"Неактивний"}),e.jsx(_,{variant:"outline",children:F(s.type)})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-medium",children:[s.price," ",s.currency]})]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[s.duration_days," днів"]})]}),s.description&&e.jsx("p",{className:"text-muted-foreground",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{c(s),n(!0)},children:e.jsx(O,{className:"w-4 h-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>D.mutate(s.id),className:"text-red-600 hover:text-red-700",children:e.jsx(R,{className:"w-4 h-4"})})]})]})},s.id))})]})]})]})}export{de as default};
