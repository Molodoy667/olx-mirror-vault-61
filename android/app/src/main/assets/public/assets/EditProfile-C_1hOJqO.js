import{u as b,h as w,r as d,j as e,B as x,s as v,t as j}from"./index-KbJkRX07.js";import{H as y,b as _}from"./Footer-CG381HwE.js";import{I as m}from"./input-BfmWFPkP.js";import{L as o}from"./label-CwWGJCIM.js";import{U as X}from"./user-Dt39FPRe.js";import{U as F}from"./upload-C80PTcyb.js";import{M as P}from"./map-pin-0eGOnbmD.js";import{P as U}from"./phone-UGyajYV9.js";import"./useAdmin-wN6CKAL8.js";import"./Combination-CN-dILO0.js";import"./badge-DpjjU75J.js";import"./index-D5jjwgwZ.js";import"./select-CxSQralT.js";import"./index-ohYBQjSJ.js";import"./globe-BvyP_gKp.js";import"./uk-Drv84rxe.js";import"./star-B840Te7u.js";import"./eye-jg7wg44x.js";import"./heart-BstkNJZ-.js";import"./avatar-CGybcn-y.js";import"./search-B1u6Ento.js";import"./plus-D5zmitre.js";function W(){const i=b(),{user:r}=w(),[c,p]=d.useState(!1),[u,h]=d.useState(""),[s,l]=d.useState({full_name:"",username:"",location:"",phone:""});d.useEffect(()=>{if(!r){i("/auth");return}(async()=>{const{data:a,error:n}=await v.from("profiles").select("*").eq("id",r.id).single();a&&(l({full_name:a.full_name||"",username:a.username||"",location:a.location||"",phone:a.phone||""}),h(a.avatar_url||""))})()},[r,i]);const g=t=>{var f;const a=(f=t.target.files)==null?void 0:f[0];if(!a)return;const n=new FileReader;n.onloadend=()=>{h(n.result)},n.readAsDataURL(a)},N=async t=>{if(t.preventDefault(),!!r){p(!0);try{const{error:a}=await v.from("profiles").upsert({id:r.id,...s,avatar_url:u,updated_at:new Date().toISOString()});if(a)throw a;j({title:"Профіль оновлено!",description:"Ваші дані успішно збережено"}),i(`/profile/${r.id}`)}catch(a){j({title:"Помилка",description:a.message||"Не вдалося оновити профіль",variant:"destructive"})}finally{p(!1)}}};return r?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(y,{}),e.jsx("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:e.jsxs("div",{className:"bg-card rounded-lg p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Редагувати профіль"}),e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-muted flex items-center justify-center overflow-hidden",children:u?e.jsx("img",{src:u,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx(X,{className:"w-12 h-12 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsxs(o,{htmlFor:"avatar",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary hover:underline",children:[e.jsx(F,{className:"w-4 h-4"}),"Змінити фото"]}),e.jsx("input",{id:"avatar",type:"file",accept:"image/*",onChange:g,className:"hidden"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"JPG, PNG. Макс. 5MB"})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"full_name",children:"Повне ім'я"}),e.jsx(m,{id:"full_name",value:s.full_name,onChange:t=>l({...s,full_name:t.target.value}),placeholder:"Іван Іваненко"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"username",children:"Ім'я користувача"}),e.jsx(m,{id:"username",value:s.username,onChange:t=>l({...s,username:t.target.value}),placeholder:"@username"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"location",children:"Місцезнаходження"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(m,{id:"location",value:s.location,onChange:t=>l({...s,location:t.target.value}),placeholder:"Київ, Україна",className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"phone",children:"Телефон"}),e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(m,{id:"phone",value:s.phone,onChange:t=>l({...s,phone:t.target.value}),placeholder:"+380 XX XXX XX XX",className:"pl-10"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>i(`/profile/${r.id}`),disabled:c,children:"Скасувати"}),e.jsx(x,{type:"submit",className:"flex-1",disabled:c,children:c?"Збереження...":"Зберегти зміни"})]})]})]})}),e.jsx(_,{})]}):null}export{W as default};
